
<div class="space-y-12">
  <!-- Header -->
  <div>
    <h1 class="text-3xl font-bold text-text-primary dark:text-slate-100">{{ t.hub_title() }}</h1>
    <p class="mt-1 text-sm text-text-secondary dark:text-slate-400">{{ t.hub_subtitle() }}</p>
  </div>

  <!-- AI-Powered Suggestions -->
  <section>
    <h2 class="text-xl font-bold text-text-primary dark:text-slate-100 mb-4">{{ t.ai_title() }}</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      @for (insight of aiInsights(); track insight.id) {
        <div class="bg-primary-light/50 dark:bg-slate-800 border border-primary/20 dark:border-slate-700 p-4 rounded-lg flex items-start space-x-3">
          <div class="flex-shrink-0 h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center">
            <svg class="h-5 w-5 text-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 2a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 2ZM10 15a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 15ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6ZM5.432 4.067a.75.75 0 0 1 1.06-1.06l1.061 1.06a.75.75 0 0 1-1.06 1.06l-1.06-1.06ZM13.48 12.42a.75.75 0 0 1 1.06-1.06l1.06 1.06a.75.75 0 0 1-1.06 1.06l-1.06-1.06ZM2 10a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 0 1.5h-1.5A.75.75 0 0 1 2 10ZM15 10a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 0 1.5h-1.5A.75.75 0 0 1 15 10ZM5.432 15.933a.75.75 0 0 1-1.06-1.06l1.06-1.061a.75.75 0 1 1 1.06 1.06l-1.06 1.061ZM13.48 7.58a.75.75 0 0 1-1.06-1.06l1.06-1.06a.75.75 0 0 1 1.06 1.06l-1.06 1.06Z" /></svg>
          </div>
          <div>
            <p class="text-sm font-semibold text-text-primary dark:text-slate-200" [innerHTML]="insight.title"></p>
            <button class="text-xs font-bold text-primary dark:text-indigo-400 hover:underline mt-1">Activate Flow</button>
          </div>
        </div>
      }
    </div>
  </section>

  <!-- Categories -->
  @for(category of categories(); track category.key) {
    <section>
      <h2 class="text-xl font-bold text-text-primary dark:text-slate-100 mb-4">{{ category.name }}</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        @for(integration of category.items; track integration.id) {
          <div class="bg-card dark:bg-slate-800 border border-border dark:border-slate-700 rounded-lg p-5 flex flex-col justify-between hover:shadow-lg hover:border-primary/50 dark:hover:border-indigo-500/50 transition-all duration-200">
            <div>
              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                   <div class="h-10 w-10 flex items-center justify-center rounded-lg" [class]="integration.bgColor ? integration.bgColor : 'bg-slate-100 dark:bg-slate-700'">
                      <img [src]="integration.logo" [alt]="integration.name" class="h-6 w-6 object-contain">
                   </div>
                   <h3 class="font-bold text-lg text-text-primary dark:text-slate-100">{{ integration.name }}</h3>
                </div>
                <span class="text-xs font-semibold px-2 py-0.5 rounded-full" [class]="{
                  'bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300': integration.status === 'connected',
                  'bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300': integration.status === 'available',
                  'bg-sky-100 text-sky-800 dark:bg-sky-900/40 dark:text-sky-300': integration.status === 'coming_soon'
                }">{{ getIntegrationStatus(integration.status) }}</span>
              </div>
              <p class="mt-3 text-sm text-text-secondary dark:text-slate-400 h-10">{{ integration.description }}</p>
            </div>
            <div class="mt-4">
              <button (click)="openSlideOver(integration)" class="w-full px-4 py-2 rounded-md font-semibold text-sm transition-colors"
                [class]="integration.status === 'connected' ? 'bg-primary-light/50 dark:bg-indigo-900/30 text-primary dark:text-indigo-300 hover:bg-primary-light dark:hover:bg-indigo-900/50' : 'bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600'">
                {{ getIntegrationAction(integration.status) }}
              </button>
            </div>
          </div>
        }
      </div>
    </section>
  }
</div>

<!-- Slide-over Panel -->
@if(isSlideOverOpen() && selectedIntegration(); as integration) {
  <div class="fixed inset-0 z-50 overflow-hidden" (click)="closeSlideOver()">
    <div class="absolute inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity"></div>
    <div class="fixed inset-y-0 right-0 flex max-w-full pl-10" (click)="$event.stopPropagation()">
        <div class="w-screen max-w-md">
            <div class="flex h-full flex-col overflow-y-scroll bg-card dark:bg-slate-800 shadow-xl border-l border-border dark:border-slate-700">
                <div class="p-6">
                  <div class="flex items-start justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="h-12 w-12 flex items-center justify-center rounded-lg" [class]="integration.bgColor ? integration.bgColor : 'bg-slate-100 dark:bg-slate-700'">
                            <img [src]="integration.logo" [alt]="integration.name" class="h-7 w-7 object-contain">
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-text-primary dark:text-slate-100">{{ integration.name }}</h2>
                            <p class="text-sm text-text-secondary dark:text-slate-400">{{ integration.description }}</p>
                        </div>
                    </div>
                    <div class="ml-3 flex h-7 items-center">
                      <button type="button" (click)="closeSlideOver()" class="rounded-md bg-card dark:bg-slate-800 text-slate-400 hover:text-slate-500 focus:outline-none focus:ring-2 focus:ring-primary">
                        <span class="sr-only">Close panel</span>
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
                      </button>
                    </div>
                  </div>
                </div>
                
                <div class="border-y border-border dark:border-slate-700 p-6">
                    <button class="w-full px-4 py-2 rounded-md font-semibold text-sm transition-colors bg-primary text-primary-foreground hover:bg-primary-hover">
                        {{ integration.status === 'connected' ? t.slideover_manage() : t.slideover_connect_to(integration.name) }}
                    </button>
                </div>

                <div class="p-6">
                    <h3 class="font-bold text-text-primary dark:text-slate-200">{{ t.slideover_title() }}</h3>
                    <p class="text-sm text-text-secondary dark:text-slate-400">{{ t.slideover_subtitle() }}</p>

                    <div class="mt-4 space-y-4">
                        @for(flow of integration.flows; track flow.id) {
                            <div class="p-4 rounded-lg" [class]="isFlowActive(flow.id) ? 'bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400' : 'bg-slate-50 dark:bg-slate-700/50'">
                                <div class="flex items-start justify-between">
                                    <p class="text-sm font-semibold text-text-primary dark:text-slate-200 pr-4">{{ flow.description }}</p>
                                    <div class="w-10 h-6 flex items-center rounded-full cursor-pointer" [class]="isFlowActive(flow.id) ? 'bg-green-500' : 'bg-slate-300 dark:bg-slate-600'" (click)="toggleFlow(flow.id)">
                                        <div class="h-4 w-4 rounded-full bg-white transform transition-transform" [class.translate-x-4]="isFlowActive(flow.id)"></div>
                                    </div>
                                </div>
                                @if(flow.premium) {
                                    <div class="mt-2">
                                        <span class="text-xs font-bold text-primary dark:text-indigo-400">PRO</span>
                                    </div>
                                }
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>
}
